## 교착 상태란

- 두 개 이상의 프로세스가 각자 가지고 있는 자원을 무작정 기다린다면 그 어떤 프로세스도 더 이상 진행할 수 없는 교착 상태가 된다.

### 식사하는 철학자 문제

그림

- 모두가 왼쪽 포크를 집어들면 모두가 오른쪽 포크를 들 수 없게 된다.
- 철학자 => 프로세스 혹은 스레드, 포크 => 자원, 생각하는 행위 => 자원을 기다리는 것

### 자원 할당 그래프

- 어떤 프로세스가 어떤 자원을 사용하고 있고, 어떤 프로세스가 어떤 자원을 기다리고 있는지를 표현한 그래프

1. 프로세스는 원으로, 자원의 종류는 사각형으로 표현
2. 사용할 수 있는 자원의 개수는 자원 사각형 내에 점으로 표현
3. 프로세스가 어떤 자원을 할당받아 사용 중이라면 자원에서 프로세스를 향해 화살표를 표시
4. 프로세스가 어떤 자원을 기다리고 있다면 프로세스에서 자원으로 화살표를 표시
   371 그림 1,2

### 교착 상태 발생 조건

_아래의 조건이 모두 만족될 때 교착 상태가 발생할 가능성이 생김!!_

#### 상호 배제

- 한 프로세스가 사용하는 자원을 다른 프로세스가 사용할 수 없을 때, 즉 상호 배제 상황에서 교착 상태가 발생할 수 있다.

#### 점유와 대기

- 자원을 할당받은 상태에서 다른 자원을 할당받기를 기다리는 상태를 점유와 대기라고 하는데, 이렇게 기다린다면 교착 상태가 발생할 수 있다.

#### 비선점

- 어떤 프로세스도 다른 프로세스의 자원을 강제로 빼앗지 못할 때 교착 상태가 발생할 수 있다.

#### 원형 대기

- 자원 할당 그래프가 원의 형태로 그려지면 교착 상태가 발생할 수 있다.

## 교착 상태 해결 방법

- 운영체제는 교착 상태가 일어나지 않도록 교착 상태 발생 조건에 부합하지 않게 자원을 분배하여 교착 상태를 예방할 수 있고, 교착 상태의 위험이 있다면 자원을 할당하지 않는 방식으로 교착 상태를 회피할 수도 있다.
- 자원을 제약 없이 할당하다가 교착 상태가 검출되면 교착 상태를 회복하는 방법을 취할 수도 있다.

### 교착 상태 예방

- `교착 상태 발생 조건` 4가지 중 하나를 충족하지 못하게 한다.
- 1. 상호배제 없애기 : 현실적으로 무리가 있다.
- 2. 점유와 대기 없애기 : 자원 활용률이 낮아질 우려가 있다. 그리고 많은 자원을 사용하는 프로세스가 불리해진다.
- 3. 비선점 조건 없애기 : CPU는 프로세스들이 선점할 수 있는 대표적인 자원이기 때문에 효과적이지만 프린터와 같은 자원이 있다면 비선점 조건을 없애기 어렵다.
- 4. 원형대기 조건 없애기 : 모든 자원에 번호를 붙이고, 오름차순으로 자원을 할당하면 원형 대기는 발생하지 않는다. 하지만 모든 컴퓨터 시스템 내에 존재하는 수많은 자원에 번호를 붙이는 일은 어렵고, 각 자원에 어떤 번호를 붙이는지에 따라 특정 자원의 활용률이 떨어질 수 있다.

### 교착 상태 회피

- 교착 상태 회피 : 교착 상태가 발생하지 않을 정도로만 조심히 자원을 할당하는 방식이다.
- `안전 상태` : 교착 상태가 발생하지 않고 모든 프로세스가 정상적으로 자원을 할당받고 종료될 수 있는 상태
- `불안전 상태` : 교착 상태가 발생할 수도 있는 상황
- `안전 순서열` : 교착 상태 없이 안전하게 프로세스들에 자원을 할당할 수 있는 순서를 의미한다.
  - 안전 순서열 대로 프로세스들에 자원을 배분하여 교착 상태가 발생하지 않는 상태를 **안전 상태**라고 한다.
- `불안전 상태` : 안전 순서열이 없는 상황으로, 시스템이 불안전 상태에 놓이면 교착 상태가 발생할 수 있는 위험이 있다.
  그림

### 교착 상태 검출 후 회복

- 교착 상태 검출 후 회복 : 교착 상태 발생을 인정하고 사후에 조치하는 방식

#### 선점을 통한 회복

- 교착 상태가 해결될 때까지 한 프로세스씩 자원을 몰아주는 방식이다.
- 다른 프로세스로부터 자원을 강제로 빼앗고 한 프로세스에 할당하는 방식이다.

#### 프로세스 강제 종료를 통한 회복

- 가장 단순하면서 확실한 방식이다.
- 그러나 그만큼 많은 프로세스들이 작업 내역을 잃게 될 가능성이 있고, 오버헤드를 야기한다.
