## 연속 메모리 할당

- 프로세스에 연속적인 메모리 공간을 할당하는 방식

### 스와핑

- 정의 : 메모리에 적재된 프로세스들 중 현재 실행되지 않는 프로세스들을 보조기억장치 일부 영역으로 쫒아내고, 메모리상의 빈 공간에 또다른 프로세스를 적재하여 실행하는 방식
- 스왑 영역 : 프로세스들이 쫒겨난 보조기억장치의 일부 영역
- 스왑 아웃 : 현재 실행되지 않는 프로세스가 메모리에서 스왑 영역으로 옮겨지는 것
- 스왑 인 : 스왑 영역에 있던 프로세스가 다시 메모리로 옮겨오는 것. 스왑 아웃되기 전의 물리 주소와 다를 수 있음
### 메모리 할당

- 최초 적합 : 최초로 발견한 적재 가능한 빈 공간에 프로세스 배치
- 최적 적합 : 프로세스가 적재될 수 있는 가장 작은 메모리 공간에 프로세스 배치
- 최악 적합 : 프로세스가 적재될 수 있는 가장 큰 공간에 프로세스를 배치

### 외부 단편화

정의 : 프로세스를 할당하기 어려울 만큼 작은 메모리 공간들로 인해 메모리가 낭비되는 현상 <br>

해결 방법

#### 압축

- 정의 : 메모리 내에 저장된 프로세스를 적당히 재배치시켜 여기저기 흩어져 있는 작은 빈 공간들을 하나의 큰 빈공간으로 만드는 방법
- 단점1 : 작은 빈 공간들을 하나로 모으는 동안 시스템은 하던 일을 중지
- 단점2 : 메모리에 있는 내용을 옮기는 작업은 많은 오버헤드
- 어떤 프로세스를 어떻게 움직여야 오버헤드를 최소화하며 압축할 수 있는지에 대한 명확한 방법을 결정하기 어렵다. 그래서 나온게 가상 메모리 기법


## 페이징을 통한 가상 메모리 관리

### 가상메모리 
- 실행하고자 하는 프로그램을 일부만 메모리에 적재하여 실제 물리 메모리 크기보다 더 큰 프로세스를 실행할 수 있게 하는 기술
- 가상 메모리 관리 기법에는 크게 페이징, 세그멘테이션이 있다

### 페이징

- 메모리의 물리 주소 공간을 프레임 단위로 자르고, 
프로세스의 논리 주소 공간을 페이지 단위로 자른 뒤 각 페이지를 프레임에 할당하는 가상 메모리 관리 기법
- 페이지 단위로 스왑 아웃, 스왑 인이 가능하다. 이땐 페이지 인, 페이지 아웃 이라고 표현
- 실행에 필요한 일부 페이지만을 메모리에 적재하기 떄문에 물리 메모리보다 큰 프로세스를 실행할 수 있다.


### 페이지 테이블
프로세스가 물리 주소에 불연속적으로 배치 되더라도 논리 주소에는 연속적으로 배치되도록 하는 페이지 번호와 프레임 번호를 짝지어 주는 이정표

- 내부 단편화 : 하나의 페이지 크기보다 작은 크기로 발생한다. 하나의 페이지 크기가 작다면 내부 단편화의 크기는 작아지지만 페이지 테이블의 크기도 커지기 때문에 너무 크지 않은 페이지 테이블이 만들어지도록 조정 필요
- 페이지 테이블 베이스 레지스터 : 각 프로세스의 페이지 테이블이 적재된 주소를 가리킨다.
- TLB : 페이지 테이블의 캐시 메모리 역할을 수행하기 위해 페이지 테이블의 일부를 저장.

### 페이징에서의 주소 변환

#### 특정 주소에 접근 하기 위해서 필요한 것

- 어떤 페이지 혹은 프레임에 접근하고 싶은지 (페이지 번호)
- 접근하려는 주소가 그 페이지 혹은 프레임으로부터 얼마나 떨어져 있는지 (변위)
- 페이지 번호 : 접근하고자 하는 페이지 번호
- 변위 : 접근하려는 주소가 프레임의 시작 번지로부터 얼만큼 떨어져 있는지를 알기 위한 정보

### 페이지 테이블 엔트리
정의 : 페이지 테이블의 각각의 행
- 유효 비트 : 현재 해당 페이지에 접근 가능한지 여부를 알려준다.
- 페이지 폴트 : CPU가 유효 비트가 0인 메모리에 적재되어 있지 않은 페이지로 접근 하려고 할때 발생 시키는 인터럽트
- 보호 비트 : 해당 페이지가 읽고 쓰기의 유무를 나타내는 비트로 rwx의 조합을 나타낼 수도 있다.
- 참조 비트 : CPU가 이페이지에 접근한 적이 있는지 여부를 나타낸다.
- 수정 비트(더티 비트) : 해당 페이지에 데이터를 쓴 적이 있는지 없는지 수정 여부를 알려준다.

##### 페이징의 이점 - 쓰기 시 복사

-

##### 계층적 페이징

-

## 페이지 교체와 프레임 할당

### 요구 페이징

- 정의 : 프로세스를 메모리에 적재할 때 처음부터 모든 페이지를 적재하지 않고 필요한 페이지만을 메모리에 적재하는 기법.

- 요구 페이징의 기본적인 양상
  1. CPU가 특정 페이지에 접근하는 명령어 실행
  2. 해당 페이지 유효 비트가 1일 경우 CPU는 페이지가 적재된 프레임에 접근
  3. 해당 페이지 유효 비트가 0일 경우 페이지 폴트 발생
  4. 페이지 폴트 처리 루틴은 해당 페이지를 메모리로 적재하고 유효 비트를 1로 설정
  5. 1번부터 다시 실행

- 순수 요구 페이징 
  - 아무런 페이지도 메모리에 적재하지 않은 채 무작정실행
  - 프로세스의 첫 명령어를 실행하는 순간부터 페이지 폴트 발생
  - 실행에 필요한 페이지가 어느 정도 이후 부터는 페이지 폴트 발생 빈도가 떨어진다.

- 페이지 교체 
  - 당장 실행에 필요한 페이지를 적재하기 위해 메모리에 적재된 페이지를 보조기억장치로 내보내는 것
  - 페이지 교체 알고리즘 으로 쫒아낼 페이지 결정

### 페이지 교체 알고리즘

- 좋은 알고리즘 : 일반적으론 페이지 폴트를 가장 적게 일으키는 알고리즘
- 페이지 참조열 : 페이지 폴트 횟수를 알 수 있게 해주는 것 으로 CPU가 참조하는 페이지들 중 연속된 페이지를 생략한 페이지열 ex(2 2 2 3 5 5 5 3 3 7 => 2 3 5 3 7)
- FIFO 페이지 교체 알고리즘 : 메모리에 가장 먼저 올라온 페이지부터 내쫒는다.
- 2차 기회 페이지 교체 알고리즘 : FIFO 페이지 교체 알고리즘에서 기회를 1회 더 준다.
- 최적 페이지 교체 알고리즘 : 앞으로 오랫동안 사용되지 않은 페이지를 내보낸다. 미래를 예측 해야 하기에 구현 어렵다. 페이지 교체 알고리즘을 평가하는 용도로 사용
- LRU 페이지 교체 알고리즘 : 가장 오랫동안 사용되지 않은 페이지를 교체

### 스래싱과 프레임 할당

- 스래싱 : 프로세스가 실제 실행되는 시간보다 페이징에 더 많은 시간을 소요하여 성능이 저하되는 문제
- 멀티프로그래밍의 정도 : 메모리에서 동시실행되는 프로세스의 수

동시에 실행되는 프로세스의 수를 늘린다고 해서 CPU 이용률이 이에 비례해서 증가하진 않는다. 각 프로세스들이 사용할 수 있는 프레임 수가 적어 페이지 폴트가 지나치게 발생하기 떄문

#### 프레임 할당 방식
- 균등 할당 : 모든 프로세스에 동일한 프레임을 배분
- 비례 할당 : 프로세스 크기에 따라 프레임을 배분
- 작업 집합 모델 : 프로세스가 일정 기간 참조한 페이지 집합의 크기만큼 프레임 할당
- 페이지 폴트 빈도 : 페이지 폴트율에 상한선과 하한선을 정하고, 그 내부 범위 안에서 프레임 할당